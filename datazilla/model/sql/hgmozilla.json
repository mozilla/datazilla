{
    "inserts":{
        "set_pushlog":{
            "sql":"INSERT INTO `pushlogs` (`push_id`, `date`, `user`, `branch_id`)
                   VALUES (?, ?, ?, ?)",
            "host":"master_host"
        },
        "set_node":{
            "sql":"INSERT INTO `changesets` (`node`, `author`, `branch`, `desc`, `pushlog_id`)
                   VALUES (?,?,?,?,?)",
            "host":"master_host"
        }
    },
    "selects":{
        "get_last_insert_id":{
            "sql":"SELECT LAST_INSERT_ID() AS 'id'",
            "host":"master_host"
        },
        "get_all_branches":{
            "sql":"SELECT id, name, uri FROM branches",
            "host":"master_host"
        },
        "get_all_pushlogs":{
            "sql":"SELECT * FROM pushlogs",
            "host":"master_host"
        },
        "get_pushlog":{
            "sql":"SELECT * FROM pushlogs where push_id = ?",
            "host":"master_host"
        },
        "get_all_changesets":{
            "sql":"SELECT * FROM changesets",
            "host":"master_host"
        },
        "get_changesets":{
            "sql":"SELECT * FROM changesets where pushlog_id = ?",
            "host":"master_host"
        },
        "get_branch_pushlog":{
            "sql":"SELECT p.id AS 'pushlog_id',
                          p.push_id,
                          p.date,
                          c.node,
                          b.id AS 'branch_id',
                          b.name
                   FROM pushlogs AS p
                   LEFT JOIN changesets AS c ON p.id = c.pushlog_id
                   LEFT JOIN branches AS b ON p.branch_id = b.id
                   WHERE b.id = ? AND ( p.date >= ? AND p.date <= ?)
                   ORDER BY b.name, p.date ASC",
            "host":"master_host"
        },

        "get_all_branch_pushlogs":{
            "sql":"SELECT p.id AS 'pushlog_id',
                          p.push_id,
                          p.date,
                          c.node,
                          b.id AS 'branch_id',
                          b.name
                   FROM pushlogs AS p
                   LEFT JOIN changesets AS c ON p.id = c.pushlog_id
                   LEFT JOIN branches AS b ON p.branch_id = b.id
                   WHERE b.id = ?
                   ORDER BY b.name, p.date ASC",
            "host":"master_host"
        },

        "get_node_from_revision":{
            "sql":"SELECT p.id AS 'pushlog_id',
                          p.push_id,
                          p.date,
                          b.id AS 'branch_id',
                          b.name,
                          c.node
                   FROM pushlogs AS p
                   LEFT JOIN changesets AS c ON p.id = c.pushlog_id
                   LEFT JOIN branches AS b ON p.branch_id = b.id
                   WHERE INSTR(node, ?) AND b.name = ?",

            "host":"master_host"
        }
    }
}
